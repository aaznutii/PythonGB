-- Делал по подобию, которое обсуждалось на уроке.
SELECT DISTINCT 
  COMMUNITIES.NAME AS GROUP_,
  COUNT(COMMUNITIES_USERS.USER_ID) OVER() / (SELECT COUNT(*) FROM COMMUNITIES) AS AVG_USERS,
  FIRST_VALUE(CONCAT(USERS.FIRST_NAME, " ", USERS.LAST_NAME)) OVER (W_COMMUNITY ORDER BY PROFILES.BIRTHDAY DESC) AS YOUNGEST,
  FIRST_VALUE(CONCAT(USERS.FIRST_NAME, " ", USERS.LAST_NAME)) OVER (W_COMMUNITY ORDER BY PROFILES.BIRTHDAY ASC) AS OLDEST,
  COUNT(COMMUNITIES_USERS.USER_ID) OVER W_COMMUNITY AS COUNT_IN_GROUP,
  (SELECT COUNT(*) FROM USERS) AS USERS_TOTAL,
  COUNT(COMMUNITIES_USERS.USER_ID) OVER W_COMMUNITY / (SELECT COUNT(*) FROM USERS) *100 AS '%'
    FROM COMMUNITIES
      LEFT JOIN COMMUNITIES_USERS ON COMMUNITIES_USERS.COMMUNITY_ID = COMMUNITIES.ID
      LEFT JOIN USERS ON COMMUNITIES_USERS.USER_ID = USERS.ID
      LEFT JOIN PROFILES ON PROFILES.USER_ID = USERS.ID
      WINDOW W_COMMUNITY AS (PARTITION BY COMMUNITIES.ID);